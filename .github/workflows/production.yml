name: Test FTP Connection

on:
  push:
    branches:
      - main  # Trigger deployment on push to the 'main' branch

jobs:
  test-ftp:
    name: Test FTP Connection
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v3

      # Test FTP Connection
      - name: Test FTP Connection to cPanel
        uses: SamKirkland/FTP-Deploy-Action@4.2.0
        with:
          server: ${{ secrets.FTP_HOST }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          server-dir: ${{ secrets.FTP_PATH }}/enterprise/api/  # Temporary test directory
          port: 21
          local-dir: ./test-file/  # Directory containing a test file
          debug: true  # Enable verbose logging to see connection details

      # Cleanup test directory (optional)
      - name: Cleanup Test Directory
        run: |
          echo "Deleting test file from the repository after test."
          rm -rf ./test-file
